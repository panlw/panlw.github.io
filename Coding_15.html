<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
    
  Coding - Junkman
  
  </title>
  
  
  <link href="atom.xml" rel="alternate" title="Junkman" type="application/atom+xml">
    <link rel="stylesheet" href="asset/css/foundation.min.css" />
    <link rel="stylesheet" href="asset/css/docs.css" />
    <script src="asset/js/vendor/modernizr.js"></script>
    <script src="asset/js/vendor/jquery.js"></script>
  <script src="asset/highlightjs/highlight.pack.js"></script>
  <link href="asset/highlightjs/styles/github.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script>hljs.initHighlightingOnLoad();</script>
<script type="text/javascript">
  function before_search(){
    var searchVal = 'site:panlw.github.io ' + document.getElementById('search_input').value;
    document.getElementById('search_q').value = searchVal;
    return true;
  }
</script>
  </head>
  <body class="antialiased hide-extras">
    
    <div class="marketing off-canvas-wrap" data-offcanvas>
      <div class="inner-wrap">


<nav class="top-bar docs-bar hide-for-small" data-topbar>


  <section class="top-bar-section">
  <div class="row">
      <div style="position: relative;width:100%;"><div style="position: absolute; width:100%;">
        <ul id="main-menu" class="left">
        
        <li id=""><a target="self" href="index.html">Home</a></li>
        
        <li id=""><a target="_self" href="archives.html">Archives</a></li>
        
        </ul>

        <ul class="right" id="search-wrap">
          <li>
<form target="_blank" onsubmit="return before_search();" action="http://google.com/search" method="get">
    <input type="hidden" id="search_q" name="q" value="" />
    <input tabindex="1" type="search" id="search_input"  placeholder="Search"/>
</form>
</li>
          </ul>
      </div></div>
  </div>
  </section>

</nav>

        <nav class="tab-bar show-for-small">
  <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
    <span> &nbsp; Junkman</span>
  </a>
</nav>

<aside class="left-off-canvas-menu">
      <ul class="off-canvas-list">
       
       <li><a href="index.html">HOME</a></li>
    <li><a href="archives.html">Archives</a></li>
    <li><a href="about.html">ABOUT</a></li>

    <li><label>Categories</label></li>

        
            <li><a href="Infra.html">Infra</a></li>
        
            <li><a href="Coding.html">Coding</a></li>
        
            <li><a href="Solution.html">Solution</a></li>
        
            <li><a href="Archtect.html">Archtect</a></li>
         

      </ul>
    </aside>

<a class="exit-off-canvas" href="#"></a>


        <section id="main-content" role="main" class="scroll-container">
        
       

 <script type="text/javascript">
	$(function(){
		$('#menu_item_index').addClass('is_active');
	});
</script>
<div class="row">
	<div class="large-8 medium-8 columns">
		<div class="markdown-body home-categories">
		
			<div class="article">
                <a class="clearlink" href="15331089375454.html">
                
                  <h1>Elm architecture with React + Redux + Redux-loop</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<p><a href="https://smallbusinessforum.co/elm-architecture-with-react-redux-redux-loop-645a67070b1a">https://smallbusinessforum.co/elm-architecture-with-react-redux-redux-loop-645a67070b1a</a></p>

<p><img src="https://cdn-images-1.medium.com/max/800/1*Or0o-_dFsZe1ahMAC2yLZQ.png" alt=""/></p>

<p>When I started learning React I have beed so confused with Flux architecture. I understand problem which Flux trying to solve, but i don’t have a clue how to do it properly.</p>

<p>After playing with <a href="https://github.com/facebook/flux">Facebook Flux implementation</a> it was good for me but i wanted to write less boilerplate code with different stores. I made my own implementation of stores with connection to dispatcher updates, but it still wasn’t looks perfect.</p>

<p>After while i discovered this great <a href="https://youtu.be/xsSnOQynTHs">presentation</a> by Dan Abramav</p>

<p>I were so excited about single atom of state and how Redux transparent looks Redux flow. It was so easy for development and I started my next project on work with React + Redux.</p>

<p>As for many developers one question wasn’t clear enough with this tools.</p>

<blockquote>
<p>How to solve side effects like http requests</p>
</blockquote>

<h3 id="toc_0">Elm</h3>

<p>I were plunged into background of Redux and found <a href="http://elm-lang.org/">Elm</a>. After learning some basics I understand that it is what I’m looking for. But Elm looks so hardcore for production development and I just made a few simple projects at home.</p>

<p><a href="https://github.com/evancz/elm-architecture-tutorial/blob/master/examples/05-http.elm">This code</a> demonstrate how easy Elm deal with side effects and extracts them from main business logic, like it never exists in your application.</p>

<p><img src="https://cdn-images-1.medium.com/max/800/1*Rfkexz95FuEZ8j4Ruv-Z8g.png" alt=""/></p>

<p>The <code>update</code> function now returns more than just a new model. It returns a new model and some commands you want to run. These commands are all going to produce <code>Msg</code> values that will get fed right back into our <code>update</code> function.</p>

<p>There is a <code>subscriptions</code> function. This function lets you declare any event sources you need to subscribe to given the current model. Just like with <code>Html Msg</code> and <code>Cmd Msg</code>, these subscriptions will produce <code>Msg</code> values that get fed right back into our <code>update</code> function.</p>

<p>One crucial detail here is that commands and subscriptions are <u>data</u>. When you create a command, you do not actually <u>do</u> it. Same with commands in real life. Point is, commands and subscriptions are data. You hand them to Elm to actually run them, giving Elm a chance to log all of this information.</p>

<p>This application flow looks so easy and transparent that i started to search similar way in React+Redux ecosystem.</p>

<p>Many methods for handling effects in Redux, especially those implemented with action-creators, incorrectly teach the user that asynchronous effects are fundamentally different from synchronous state transitions. This separation encourages divergent and increasingly specific means of processing particular types effects. Instead, we should focus on making our reducers powerful enough to handle asynchronous effects as well as synchronous state transitions.</p>

<h3 id="toc_1">Redux-thunk</h3>

<p>Redux Thunk <a href="https://github.com/gaearon/redux-thunk">middleware</a> allows you to write action creators that return a function instead of an action. The thunk can be used to delay the dispatch of an action, or to dispatch only if a certain condition is met. The inner function receives the store methods <code>dispatch</code> and <code>getState</code> as parameters.</p>

<p>Problem of thunk that inside this function you could do any what you want and never handle whats going wrong. You don’t have description of effects which need to be run.</p>

<h3 id="toc_2">Redux-saga</h3>

<p>Next thing that I found was <a href="https://github.com/redux-saga/redux-saga">Redux-saga</a>. It helps you to separate side-effects from your application, but made it more complex because actions now used in another parts of your application where you keep your sagas. So I not been satisfied at all and continue searching.</p>

<p><code>redux-saga</code> is a library that aims to make side effects (i.e. asynchronous things like data fetching and impure things like accessing the browser cache) in React/Redux applications easier and better.</p>

<p>The mental model is that a saga is like a separate thread in your application that’s solely responsible for side effects. <code>redux-saga</code> is a redux middleware, which means this thread can be started, paused and cancelled from the main application with normal redux actions, it has access to the full redux application state and it can dispatch redux actions as well.</p>

<h3 id="toc_3">Redux-loop</h3>

<p>Final catch was the best I found not popular library <a href="https://github.com/redux-loop/redux-loop">Redux-loop</a>. It solve side-effect problem in a way that I prefer.</p>

<p>After every state update it next effects needed to be run described in your state. The values returned from the reducer when scheduling an effect with redux-loop only <u>describe</u> the effect. Calling the reducer will not cause the effect to run. The value returned by the reducer is just an object that the store knows how to interpret when it is enhanced by redux-loop. You can safely call a reducer in your tests without worrying about waiting for effects to finish and what they will do to your environment.</p>

<p>With <code>redux-loop</code>, the reducer doesn&#39;t just decide what happens <u>now</u> due to a particular action, it decides what happens <u>next</u>. All of the behavior of your application can be traced through one place, and that behavior can be easily broken apart and composed back together. This is one of the most powerful features of the <a href="https://guide.elm-lang.org/architecture/">Elm architecture</a>, and with <code>redux-loop</code> it is a feature of Redux as well.</p>

<p>When I started my product <a href="https://recomea.com">Recomea</a> redux-loop become my best friend to handle side-effects.</p>

<pre><code class="language-js">...
case SIGN_IN_FACEBOOK:
  return loop(        
   state,        
   Effects.promise(         
    facebookSigninEffect,       
   )      
);
...
</code></pre>

<p>With reducers like this all my components become more clear and I forgot about horrible redux-thunk.</p>

<ul>
<li>  <a href="https://smallbusinessforum.co/tagged/redux?source=post">Redux</a></li>
<li>  <a href="https://smallbusinessforum.co/tagged/react?source=post">React</a></li>
<li>  <a href="https://smallbusinessforum.co/tagged/elm?source=post">Elm</a></li>
<li>  <a href="https://smallbusinessforum.co/tagged/javascript?source=post">JavaScript</a></li>
</ul>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2018/8/1</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='Node.js.html'>Node.js</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
              


			<div class="row">
			  <div class="large-6 columns">
			  <p class="text-left" style="padding-top:25px;">
			   <a href="Coding_14.html">&laquo; Prev Page</a>  
			  </p>
			  </div>
			  <div class="large-6 columns">
			<p class="text-right" style="padding-top:25px;">
			 <a href="Coding_16.html">&raquo; Next Page</a> 
			</p>
			  </div>
			</div>
		</div>
	</div><!-- large 8 -->

 <div class="large-4 medium-4 columns">
  <div class="hide-for-small">
    <div id="sidebar" class="sidebar">
          <div id="site-info" class="site-info">
            
                <div class="site-a-logo"><img src="./asset/img/logo.jpg" /></div>
            
                <h1>Junkman</h1>
                <div class="site-des">“拾荒者”一词来自凯文・凯利的《失控》中关于机器学习的故事（“收集癖好机”如何完成他的收集工作）。</div>
                <div class="social">









<a target="_blank" class="github" target="_blank" href="https://github.com/panlw/" title="GitHub">GitHub</a>

  <a target="_blank" class="rss" href="atom.xml" title="RSS">RSS</a>
                
              	 </div>
          	</div>

             

              <div id="site-categories" class="side-item ">
                <div class="side-header">
                  <h2>Categories</h2>
                </div>
                <div class="side-content">

      	<p class="cat-list">
        
            <a href="Infra.html"><strong>Infra</strong></a>
        
            <a href="Coding.html"><strong>Coding</strong></a>
        
            <a href="Solution.html"><strong>Solution</strong></a>
        
            <a href="Archtect.html"><strong>Archtect</strong></a>
         
        </p>


                </div>
              </div>

              <div id="site-categories" class="side-item">
                <div class="side-header">
                  <h2>Recent Posts</h2>
                </div>
                <div class="side-content">
                <ul class="posts-list">
	      
		      
			      <li class="post">
			        <a href="15358820607055.html">Java 8 Concurrency Tutorial: Atomic Variables and ConcurrentMap</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15358774987730.html">Java 8 Concurrency Tutorial: Synchronization and Locks</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15358757119900.html">Java 8 Concurrency Tutorial: Threads and Executors</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15358756631902.html">Java 8 Stream Tutorial</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15358753472382.html">Migrate Maven Projects to Java 11</a>
			      </li>
		     
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		   
		  		</ul>
                </div>
              </div>
        </div><!-- sidebar -->
      </div><!-- hide for small -->
</div><!-- large 4 -->

</div><!-- row -->

 <div class="page-bottom clearfix">
  <div class="row">
   <p class="copyright">Copyright &copy; 2015
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
Theme used <a target="_blank" href="http://github.com">GitHub CSS</a>.</p>
  </div>
</div>

        </section>
      </div>
    </div>

  
    

    <script src="asset/js/foundation.min.js"></script>
    <script>
      $(document).foundation();
      function fixSidebarHeight(){
        var w1 = $('.markdown-body').height();
          var w2 = $('#sidebar').height();
          if (w1 > w2) { $('#sidebar').height(w1); };
      }
      $(function(){
        fixSidebarHeight();
      })
      $(window).load(function(){
          fixSidebarHeight();
      });
     
    </script>

    <script src="asset/chart/all-min.js"></script><script type="text/javascript">$(function(){    var mwebii=0;    var mwebChartEleId = 'mweb-chart-ele-';    $('pre>code').each(function(){        mwebii++;        var eleiid = mwebChartEleId+mwebii;        if($(this).hasClass('language-sequence')){            var ele = $(this).addClass('nohighlight').parent();            $('<div id="'+eleiid+'"></div>').insertAfter(ele);            ele.hide();            var diagram = Diagram.parse($(this).text());            diagram.drawSVG(eleiid,{theme: 'simple'});        }else if($(this).hasClass('language-flow')){            var ele = $(this).addClass('nohighlight').parent();            $('<div id="'+eleiid+'"></div>').insertAfter(ele);            ele.hide();            var diagram = flowchart.parse($(this).text());            diagram.drawSVG(eleiid);        }    });});</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({TeX: { equationNumbers: { autoNumber: "AMS" } }});</script>


  </body>
</html>
